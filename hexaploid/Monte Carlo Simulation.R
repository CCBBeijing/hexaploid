#genotype
#alpha equal to 0

rm(list=ls())
geno.L <- c()
lr <- c()
for(i in 1:1000){
  m <- 0.1; n <-0.05; k <- 0.2; e <- 0.25
  h <- 0.13; f <-0.1; u <-0.17
  prob0 <- c(0.1,0.05,0.2,0.25,0.13,0.1,0.17)
  alpha=0
  Q71 <-(m^2*1+2*m*n*(1/2+1/6*alpha)+2*m*k*(1/5+1/5*alpha)+2*m*e*(1/20+3/20*alpha)+2*m*h*(1/15*alpha)+2*m*f*0+2*m*u*0
         +n^2*(1/4+1/36*alpha^2+1/6*alpha)+2*n*k*(1/10+1/30*alpha^2+2/15*alpha)+2*n*e*(1/40+1/40*alpha^2+1/12*alpha)+2*n*h*(1/90*alpha^2+1/30*alpha)+2*n*f*0+2*n*u*0
         +k^2*(1/25+1/25*alpha^2+2/25*alpha)+2*k*e*(1/100+3/100*alpha^2+1/25*alpha)+2*k*h*(1/75*alpha^2+1/75*alpha)+2*k*f*0+2*k*u*0
         +e^2*(1/400+9/400*alpha^2+3/200*alpha)+2*e*h*(1/100*alpha^2+1/300*alpha)+2*e*f*0+2*e*u*0
         +h^2*(1/225*alpha^2)+2*h*f*0+2*h*u*0
         +f^2*0+2*f*u*0
         +u^2*0)
  
  Q61 <-(m^2*0+2*m*n*(1/2-1/3*alpha)+2*m*k*(3/5-1/3*alpha)+2*m*e*(9/20-3/20*alpha)+2*m*h*(1/5+1/15*alpha)+2*m*f*(1/6*alpha)+2*m*u*0
         +n^2*(1/2-1/9*alpha^2-1/6*alpha)+2*n*k*(2/5-11/90*alpha^2-1/30*alpha)+2*n*e*(1/4-3/40*alpha^2+7/120*alpha)+2*n*h*(1/10-1/90*alpha^2+1/10*alpha)+2*n*f*(1/36*alpha^2+1/12*alpha)+2*n*u*0
         +k^2*(6/25-2/15*alpha^2+8/75*alpha)+2*k*e*(3/25-2/25*alpha^2+2/15*alpha)+2*k*h*(1/25-2/225*alpha^2+7/75*alpha)+2*k*f*(1/30*alpha^2+1/30*alpha)+2*k*u*0
         +e^2*(9/200-9/200*alpha^2+3/25*alpha)+2*e*h*(1/100+19/300*alpha)+2*e*f*(1/40*alpha^2+1/120*alpha)+2*e*u*0
         +h^2*(2/225*alpha^2+2/75*alpha)+2*h*f*(1/90*alpha^2)+2*h*u*0
         +f^2*0+2*f*u*0
         +u^2*0)
  
  Q51 <- (m^2*0+2*m*n*(1/6*alpha)+2*m*k*(1/5+1/15*alpha)+2*m*e*(9/20-3/20*alpha)+2*m*h*(3/5-1/3*alpha)+2*m*f*(1/2-1/3*alpha)+2*m*u*0
          +n^2*(1/4+1/6*alpha^2-1/6*alpha)+2*n*k*(2/5+7/45*alpha^2-4/15*alpha)+2*n*e*(9/20+1/20*alpha^2-13/60*alpha)+2*n*h*(2/5-1/15*alpha^2-1/10*alpha)+2*n*f*(1/4-1/9*alpha^2)+2*n*u*0
          +k^2*(11/25+31/225*alpha^2-22/75*alpha)+2*k*e*(37/100+3/100*alpha^2-11/75*alpha)+2*k*h*(6/25-19/225*alpha^2+1/25*alpha)+2*k*f*(1/10-11/90*alpha^2+2/15*alpha)+2*k*u*0
          +e^2*(99/400-9/400*alpha^2-3/200*alpha)+2*e*h*(3/25-7/100*alpha^2+31/300*alpha)+2*e*f*(1/40-3/40*alpha^2+2/15*alpha)+2*e*u*0
          +h^2*(1/25-9/225*alpha^2+8/75*alpha)+2*h*f*((-1/90)*alpha^2+1/15*alpha)+2*h*u*0
          +f^2*(1/36*alpha^2)+2*f*u*0
          +u^2*0)
  
  Q41 <- (m^2*0+2*m*n*0+2*m*k*(1/15*alpha)+2*m*e*(1/20+3/20*alpha)+2*m*h*(1/5+1/5*alpha)+2*m*f*(1/2+1/6*alpha)+2*m*u*1
          +n^2*((-1/9)*alpha^2+1/6*alpha)+2*n*k*(1/10-1/15*alpha^2+1/10*alpha)+2*n*e*(1/4+1/20*alpha^2-1/15*alpha)+2*n*h*(2/5+7/45*alpha^2-1/5*alpha)+2*n*f*(1/2+1/6*alpha^2-1/6*alpha)+2*n*u*(1/2+1/6*alpha)
          +k^2*(6/25-4/225*alpha^2-2/75*alpha)+2*k*e*(37/100+2/25*alpha^2-59/300*alpha)+2*k*h*(11/25+4/25*alpha^2-22/75*alpha)+2*k*f*(2/5+7/45*alpha^2-1/5*alpha)+2*k*u*(1/5+1/5*alpha)
          +e^2*(41/100+9/100*alpha^2-6/25*alpha)+2*e*h*(37/100+2/25*alpha^2-59/300*alpha)+2*e*f*(1/4+1/20*alpha^2-1/15*alpha)+2*e*u*(1/20+3/20*alpha)
          +h^2*(6/25-4/225*alpha^2-2/75*alpha)+2*h*f*(1/10-1/15*alpha^2+1/10*alpha)+2*h*u*(1/15*alpha)
          +f^2*((-1/9)*alpha^2+1/6*alpha)+2*f*u*0
          +u^2*0)
  
  Q31 <- (m^2*0+2*m*n*0+2*m*k*0+2*m*e*0+2*m*h*0+2*m*f*0+2*m*u*0
          +n^2*(1/36*alpha^2)+2*n*k*((-1/90)*alpha^2+1/15*alpha)+2*n*e*(1/40-3/40*alpha^2+2/15*alpha)+2*n*h*(1/10-11/90*alpha^2+2/15*alpha)+2*n*f*(1/4-1/9*alpha^2)+2*n*u*(1/2-1/3*alpha)
          +k^2*(1/25-9/225*alpha^2+8/75*alpha)+2*k*e*(3/25-7/100*alpha^2+31/300*alpha)+2*k*h*(6/25-19/225*alpha^2+1/25*alpha)+2*k*f*(2/5-1/15*alpha^2-1/10*alpha)+2*k*u*(3/5-1/3*alpha)
          +e^2*(99/400-9/400*alpha^2-3/200*alpha)+2*e*h*(37/100+3/100*alpha^2-11/75*alpha)+2*e*f*(9/20+1/20*alpha^2-13/60*alpha)+2*e*u*(9/20-3/20*alpha)
          +h^2*(11/25+31/225*alpha^2-22/75*alpha)+2*h*f*(2/5+7/45*alpha^2-4/15*alpha)+2*h*u*(1/5+1/15*alpha)
          +f^2*(1/4+1/6*alpha^2-1/6*alpha)+2*f*u*(1/6*alpha)
          +u^2*0)
  
  Q21 <-(m^2*0+2*m*n*0+2*m*k*0+2*m*e*0+2*m*h*0+2*m*f*0+2*m*u*0
         +n^2*0+2*n*k*(1/90*alpha^2)+2*n*e*(1/40*alpha^2+1/120*alpha)+2*n*h*(1/30*alpha^2+1/30*alpha)+2*n*f*(1/36*alpha^2+1/12*alpha)+2*n*u*(1/6*alpha)
         +k^2*(2/225*alpha^2+2/75*alpha)+2*k*e*(1/100+19/300*alpha)+2*k*h*(1/25-2/225*alpha^2+7/75*alpha)+2*k*f*(1/10-1/90*alpha^2+1/10*alpha)+2*k*u*(1/5+1/15*alpha)
         +e^2*(9/200-9/200*alpha^2+3/25*alpha)+2*e*h*(3/25-2/25*alpha^2+2/15*alpha)+2*e*f*(1/4-3/40*alpha^2+7/120*alpha)+2*e*u*(9/20-3/20*alpha)
         +h^2*(6/25-2/15*alpha^2+8/75*alpha)+2*h*f*(2/5-11/90*alpha^2-1/30*alpha)+2*h*u*(3/5-1/3*alpha)
         +f^2*(1/2-1/9*alpha^2-1/6*alpha)+2*f*u*(1/2-1/3*alpha)
         +u^2*0)
  
  Q11 <- (m^2*0+2*m*n*0+2*m*k*0+2*m*e*0+2*m*h*0+2*m*f*0+2*m*u*0
          +n^2*0+2*n*k*0+2*n*e*0+2*n*h*0+2*n*f*0+2*n*u*0
          +k^2*(1/225*alpha^2)+2*k*e*(1/100*alpha^2+1/300*alpha)+2*k*h*(1/75*alpha^2+1/75*alpha)+2*k*f*(1/90*alpha^2+1/30*alpha)+2*k*u*(1/15*alpha)
          +e^2*(1/400+9/400*alpha^2+3/200*alpha)+2*e*h*(1/100+3/100*alpha^2+1/25*alpha)+2*e*f*(1/40+1/40*alpha^2+1/12*alpha)+2*e*u*(1/20+3/20*alpha)
          +h^2*(1/25+1/25*alpha^2+2/25*alpha)+2*h*f*(1/10+1/30*alpha^2+2/15*alpha)+2*h*u*(1/5+1/5*alpha)
          +f^2*(1/4+1/36*alpha^2+1/6*alpha)+2*f*u*(1/2+1/6*alpha)
          +u^2*1)
  prob1 <- c(Q71,Q61,Q51,Q41,Q31,Q21,Q11)  
  
  alpha=0
  
  Q7 <-(m^2+1/4*n^2+1/25*k^2+1/400*e^2+m*n+2/5*m*k+1/10*m*e+1/5*n*k+1/20*n*e+1/50*k*e
        +alpha*(1/3*m*n+2/5*m*k+3/10*m*e+2/15*m*h+1/6*n^2+4/15*n*k+1/6*n*e+1/15*n*h+2/25*k^2+2/25*e*k+2/75*k*h+3/200*e^2+1/150*e*h)
        +alpha^2*(1/36*n^2+1/25*k^2+9/400*e^2+1/225*h^2+1/15*n*k+1/20*n*e+1/45*n*h+3/50*k*e+2/75*k*h+1/50*e*h))
  
  Q6 <-((m*n+6/5*m*k+9/10*m*e+2/5*m*h+1/2*n^2+4/5*n*k+1/2*n*e+1/5*n*h+6/25*k^2+6/25*k*e+2/25*k*h+9/200*e^2+1/50*e*h)
        +alpha*(-2/3*m*n-2/3*m*k-3/10*m*e+2/15*m*h+1/3*m*f-1/6*n^2-1/15*n*k+7/60*n*e+1/5*n*h+1/6*n*f+8/75*k^2+4/15*k*e+14/75*k*h+1/15*k*f+3/25*e^2+19/150*e*h+1/60*e*f+2/75*h^2)
        +alpha^2*(-1/9*n^2-11/45*n*k-3/20*n*e-1/45*n*h+1/18*n*f-2/15*k^2-4/25*k*e-4/225*k*h+1/15*k*f-9/200*e^2+1/20*e*f+2/225*h^2+1/45*h*f))
  
  Q5 <- ((2/5*m*k+9/10*m*e+6/5*m*h+m*f+1/4*n^2+4/5*n*k+9/10*n*e+4/5*n*h+1/2*n*f+11/25*k^2+37/50*k*e+12/25*k*h+1/5*k*f+99/400*e^2+6/25*e*h+1/20*e*f+1/25*h^2)
         +alpha*(1/3*m*n+2/15*m*k-3/10*m*e-2/3*m*h-2/3*m*f-1/6*n^2-8/15*n*k-13/30*n*e-1/5*n*h-22/75*k^2-22/75*k*e+2/25*k*h+4/15*k*f-3/200*e^2+31/150*e*h+4/15*e*f+8/75*h^2+2/15*h*f)
         +alpha^2*(1/6*n^2+14/45*n*k+1/10*n*e-2/15*n*h-2/9*n*f+31/225*k^2+3/50*k*e-38/225*k*h-11/45*k*f-9/400*e^2-7/50*e*h-3/20*e*f-9/225*h^2-1/45*h*f+1/36*f^2))
  
  Q4 <- ((1/10*m*e+2/5*m*h+m*f+2*m*u+1/5*n*k+1/2*n*e+4/5*n*h+n*f+n*u+6/25*k^2+37/50*k*e+22/25*k*h+4/5*k*f+2/5*k*u+41/100*e^2+37/50*e*h+1/2*e*f+1/10*e*u+6/25*h^2+1/5*h*f)
         +alpha*(2/15*m*k+3/10*m*e+2/5*m*h+1/3*m*f+1/6*n^2+1/5*n*k-2/15*n*e-2/5*n*h-1/3*n*f+1/3*n*u-2/75*k^2-59/150*k*e-44/75*k*h-2/5*k*f+2/5*k*u-6/25*e^2-59/150*e*h-2/15*e*f+3/10*e*u-2/75*h^2+1/5*h*f+2/15*h*u+1/6*f^2)
         +alpha^2*(-1/9*n^2-2/15*n*k+1/10*n*e+14/45*n*h+1/3*n*f-4/225*k^2+4/25*k*e+8/25*k*h+14/45*k*f+9/100*e^2+4/25*e*h+1/10*e*f-4/225*h^2-2/15*h*f-1/9*f^2))
  
  Q3 <-(alpha^2*(1/36*n^2-1/45*n*k-3/20*n*e-11/45*n*h-2/9*n*f-9/225*k^2-7/50*k*e-38/225*k*h-2/15*k*f-9/400*e^2+3/50*e*h+1/10*e*f+31/225*h^2+14/45*h*f+1/6*f^2)
        +alpha*(2/15*n*k+4/15*n*e+4/15*n*h-2/3*n*u+8/75*k^2+31/150*k*e+2/25*k*h-1/5*k*f-2/3*k*u-3/200*e^2-22/75*e*h-13/30*e*f-3/10*e*u-22/75*h^2-8/15*h*f+2/15*h*u-1/6*f^2+1/3*f*u)
        +(1/20*n*e+1/5*n*h+1/2*n*f+n*u+1/25*k^2+6/25*k*e+12/25*k*h+4/5*k*f+6/5*k*u+99/400*e^2+37/50*e*h+9/10*e*f+9/10*e*u+11/25*h^2+4/5*h*f+2/5*h*u+1/4*f^2))
  
  Q2 <-(alpha^2*(1/45*n*k+1/20*n*e+1/15*n*h+1/18*n*f+2/225*k^2-4/225*k*h-1/45*k*f-9/200*e^2-4/25*e*h-3/20*e*f-2/15*h^2-11/45*h*f-1/9*f^2)
        +alpha*(1/60*n*e+1/15*n*h+1/6*n*f+1/3*n*u+2/75*k^2+19/150*k*e+14/75*k*h+1/5*k*f+2/15*k*u+3/25*e^2+4/15*e*h+7/60*e*f-3/10*e*u+8/75*h^2-1/15*h*f-2/3*h*u-1/6*f^2-2/3*f*u)
        +(1/50*k*e+2/25*k*h+1/5*k*f+2/5*k*u+9/200*e^2+6/25*e*h+1/2*e*f+9/10*e*u+6/25*h^2+4/5*h*f+6/5*h*u+1/2*f^2+f*u))
  
  Q1 <- ((1/400*e^2+1/50*e*h+1/20*e*f+1/10*e*u+1/25*h^2+1/5*h*f+2/5*h*u+1/4*f^2+f*u+u^2)
         +alpha*(1/150*k*e+2/75*k*h+1/15*k*f+2/15*k*u+3/200*e^2+2/25*e*h+1/6*e*f+3/10*e*u+2/25*h^2+4/15*h*f+2/5*h*u+1/6*f^2+1/3*f*u)
         +alpha^2*(1/225*k^2+1/50*k*e+2/75*k*h+1/45*k*f+9/400*e^2+3/50*e*h+1/20*e*f+1/25*h^2+1/15*h*f+1/36*f^2))
 
  prob <- c(Q7,Q6,Q5,Q4,Q3,Q2,Q1)                                                                     
  
  index <- sample(c(1,2,3,4,5,6,7),100,replace = T,prob =prob)#
  
  NN <- rep(0,7)
  st <- table(index)
  NNn <- as.numeric(names(st))
  NN[NNn] <- as.numeric(st)
  n7 <- NN[1]; n6 <- NN[2]; n5 <- NN[3]; n4 <- NN[4]
  n3 <- NN[5]; n2 <- NN[6]; n1 <- NN[7]
  N=n7+n6+n5+n4+n3+n2+n1
  
  geno.p <- c()
  for(j in 1:500){
    
    R7 <- m^2+1/4*n^2+1/25*k^2+1/400*e^2+m*n+2/5*m*k+1/10*m*e+1/5*n*k+1/20*n*e+1/50*k*e
    
    R6 <- m*n+6/5*m*k+9/10*m*e+2/5*m*h+1/2*n^2+4/5*n*k+1/2*n*e+1/5*n*h+6/25*k^2+6/25*k*e+2/25*k*h+9/200*e^2+1/50*e*h
    
    R5 <- (2/5*m*k+9/10*m*e+6/5*m*h+m*f+1/4*n^2+4/5*n*k+9/10*n*e+4/5*n*h+1/2*n*f+11/25*k^2+37/50*k*e+12/25*k*h+1/5*k*f
           +99/400*e^2+6/25*e*h+1/20*e*f+1/25*h^2)
    
    R4 <- (1/10*m*e+2/5*m*h+m*f+2*m*u+1/5*n*k+1/2*n*e+4/5*n*h+n*f+n*u+6/25*k^2+37/50*k*e+22/25*k*h+4/5*k*f+2/5*k*u+41/100*e^2
           +37/50*e*h+1/2*e*f+1/10*e*u+6/25*h^2+1/5*h*f)
    
    R3 <- (1/20*n*e+1/5*n*h+1/2*n*f+n*u+1/25*k^2+6/25*k*e+12/25*k*h+4/5*k*f+6/5*k*u
           +99/400*e^2+37/50*e*h+9/10*e*f+9/10*e*u+11/25*h^2+4/5*h*f+2/5*h*u+1/4*f^2)
    
    R2<-(1/50*k*e+2/25*k*h+1/5*k*f+2/5*k*u+9/200*e^2+6/25*e*h+1/2*e*f+9/10*e*u+6/25*h^2+4/5*h*f+6/5*h*u+1/2*f^2+f*u)
    
    R1 <- 1/400*e^2+1/25*h^2+1/4*f^2+u^2+1/50*e*h+1/20*e*f+1/10*e*u+1/5*h*f+2/5*h*u+f*u    
   
    fai7.7= (2*m^2+m*n+2/5*m*k+1/10*m*e)/R7;
    fai7.6=(m*n+6/5*m*k+9/10*m*e+2/5*m*h)/R6;
    fai7.5=(2/5*m*k+9/10*m*e+6/5*m*h+m*f)/R5;
    fai7.4=(1/10*m*e+2/5*m*h+m*f+2*m*u)/R4; 
    
    fai6.7=(1/2*n^2+m*n+1/5*n*k+1/20*n*e)/R7 ;
    fai6.6=(m*n+n^2+4/5*n*k+1/2*n*e+1/5*n*h)/R6
    fai6.5=(1/2*n^2+4/5*n*k+9/10*n*e+4/5*n*h+1/2*n*f)/R5;
    fai6.4=(1/5*n*k+1/2*n*e+4/5*n*h+n*f+n*u)/R4
    fai6.3=(1/20*n*e+1/5*n*h+1/2*n*f+n*u)/R3
    
    fai5.7=(2/25*k^2+2/5*m*k+1/5*n*k+1/50*k*e)/R7
    fai5.6=(6/5*m*k+4/5*n*k+12/25*k^2+6/25*k*e+2/25*k*h)/R6
    fai5.5=(2/5*m*k+4/5*n*k+22/25*k^2+37/50*k*e+12/25*k*h+1/5*k*f)/R5
    fai5.4=(1/5*n*k+12/25*k^2+37/50*k*e+22/25*k*h+4/5*k*f+2/5*k*u)/R4
    fai5.3=(2/25*k^2+6/25*k*e+12/25*k*h+4/5*k*f+6/5*k*u)/R3
    fai5.2=(1/50*k*e+2/25*k*h+1/5*k*f+2/5*k*u)/R2
    
    fai4.7=(1/200*e^2+1/10*m*e+1/20*n*e+1/50*k*e)/R7
    fai4.6=(9/10*m*e+1/2*n*e+6/25*k*e+9/100*e^2+1/50*e*h)/R6
    fai4.5=(9/10*m*e+9/10*n*e+37/50*k*e++99/200*e^2+6/25*e*h+1/20*e*f)/R5
    fai4.4=(1/10*m*e+1/2*n*e+37/50*k*e+41/50*e^2+37/50*e*h+1/2*e*f+1/10*e*u)/R4
    fai4.3=(1/20*n*e+6/25*k*e+99/200*e^2+37/50*e*h+9/10*e*f+9/10*e*u)/R3
    fai4.2=(1/50*k*e+9/100*e^2+6/25*e*h+1/2*e*f+9/10*e*u)/R2
    fai4.1=(1/200*e^2+1/50*e*h+1/20*e*f+1/10*e*u)/R1
   
    fai3.6=(2/5*m*h+1/5*n*h+2/25*k*h+1/50*e*h)/R6
    fai3.5=(6/5*m*h+4/5*n*h+12/25*k*h+6/25*e*h+2/25*h^2)/R5
    fai3.4=(2/5*m*h+4/5*n*h+22/25*k*h+37/50*e*h+12/25*h^2+1/5*h*f)/R4
    fai3.3=(1/5*n*h+12/25*k*h+37/50*e*h+22/25*h^2+4/5*h*f+2/5*h*u)/R3
    fai3.2=(2/25*k*h+6/25*e*h+12/25*h^2+4/5*h*f+6/5*h*u)/R2
    fai3.1=(2/25*h^2+1/50*e*h+1/5*h*f+2/5*h*u)/R1
   
    fai2.5=(m*f+1/2*n*f+1/5*k*f+1/20*e*f)/R5
    fai2.4=(m*f+n*f+4/5*k*f+1/2*e*f+1/5*h*f)/R4
    fai2.3=(1/2*n*f+4/5*k*f+9/10*e*f+4/5*h*f+1/2*f^2)/R3
    fai2.2=(1/5*k*f+1/2*e*f+4/5*h*f+f^2+f*u)/R2
    fai2.1=(1/2*f^2+1/20*e*f+1/5*h*f+f*u)/R1
    
    fai1.4=(2*m*u+n*u+2/5*k*u+1/10*e*u)/R4
    fai1.3=(n*u+6/5*k*u+9/10*e*u+2/5*h*u)/R3
    fai1.2=(2/5*k*u+9/10*e*u+6/5*h*u+f*u)/R2
    fai1.1=(2*u^2+1/10*e*u+2/5*h*u+f*u)/R1
    
    P.6=(fai7.7*n7+fai7.6*n6+fai7.5*n5+fai7.4*n4)/(2*N);
    P.5=(fai6.7*n7+fai6.6*n6+fai6.5*n5+fai6.4*n4+fai6.3*n3)/(2*N);
    P.4=(fai5.7*n7+fai5.6*n6+fai5.5*n5+fai5.4*n4+fai5.3*n3+fai5.2*n2)/(2*N);
    P.3=(fai4.7*n7+fai4.6*n6+fai4.5*n5+fai4.4*n4+fai4.3*n3+fai4.2*n2+fai4.1*n1)/(2*N);
    P.2=(fai3.6*n6+fai3.5*n5+fai3.4*n4+fai3.3*n3+fai3.2*n2+fai3.1*n1)/(2*N);
    P.1=(fai2.5*n5+fai2.4*n4+fai2.3*n3+fai2.2*n2+fai2.1*n1)/(2*N);
    P.0=(fai1.4*n4+fai1.3*n3+fai1.2*n2+fai1.1*n1)/(2*N);
    geno.p <- rbind(geno.p,c(m,n,k,e,h,f,u))
    m <- P.6;n <- P.5;k <- P.4;e <- P.3;h <- P.2;f <- P.1;u <- P.0
  }
  m <- geno.p[500,1];n <- geno.p[500,2];k <- geno.p[500,3];e<- geno.p[500,4];
  h <- geno.p[500,5];f <- geno.p[500,6];u <- geno.p[500,7];
  
  geno.L <- rbind(geno.L,c(m,n,k,e,h,f,u))
  
  R.7 <- m^2+1/4*n^2+1/25*k^2+1/400*e^2+m*n+2/5*m*k+1/10*m*e+1/5*n*k+1/20*n*e+1/50*k*e
  
  R.6 <- m*n+6/5*m*k+9/10*m*e+2/5*m*h+1/2*n^2+4/5*n*k+1/2*n*e+1/5*n*h+6/25*k^2+6/25*k*e+2/25*k*h+9/200*e^2+1/50*e*h
  
  R.5 <- (2/5*m*k+9/10*m*e+6/5*m*h+m*f+1/4*n^2+4/5*n*k+9/10*n*e+4/5*n*h+1/2*n*f+11/25*k^2+37/50*k*e+12/25*k*h+1/5*k*f
          +99/400*e^2+6/25*e*h+1/20*e*f+1/25*h^2)
  
  R.4 <- (1/10*m*e+2/5*m*h+m*f+2*m*u+1/5*n*k+1/2*n*e+4/5*n*h+n*f+n*u+6/25*k^2+37/50*k*e+22/25*k*h+4/5*k*f+2/5*k*u+41/100*e^2
          +37/50*e*h+1/2*e*f+1/10*e*u+6/25*h^2+1/5*h*f)
  
  R.3 <- (1/20*n*e+1/5*n*h+1/2*n*f+n*u+1/25*k^2+6/25*k*e+12/25*k*h+4/5*k*f+6/5*k*u
          +99/400*e^2+37/50*e*h+9/10*e*f+9/10*e*u+11/25*h^2+4/5*h*f+2/5*h*u+1/4*f^2)
  
  R.2<-(1/50*k*e+2/25*k*h+1/5*k*f+2/5*k*u+9/200*e^2+6/25*e*h+1/2*e*f+9/10*e*u+6/25*h^2+4/5*h*f+6/5*h*u+1/2*f^2+f*u)
  
  R.1 <- 1/400*e^2+1/25*h^2+1/4*f^2+u^2+1/50*e*h+1/20*e*f+1/10*e*u+1/5*h*f+2/5*h*u+f*u    
  
  
  exp <- c(R.7,R.6,R.5,R.4,R.3,R.2,R.1) 
  
  logL1 <- (n7*log(exp[1])+n6*log(exp[2])+n5*log(exp[3])+n4*log(exp[4])+n3*log(exp[5])+n2*log(exp[6])+n1*log(exp[7]))
  logL0 <- (n7*log(prob1[1])+n6*log(prob1[2])+n5*log(prob1[3])+n4*log(prob1[4])+n3*log(prob1[5])+n2*log(prob1[6])+n1*log(prob1[7]))
  
  LR <- -2*(logL0-logL1)
  
  lr <- c(lr,LR)
}

#=============alpha not equal to 0================

rm(list=ls())

geno.L <- c()
lr <- c()
for(i in 1:1000){
  m <- 0.1; n <-0.05; k <- 0.2; e <- 0.25
  h <- 0.13; f <-0.1; u <-0.17
  prob0 <- c(0.1,0.05,0.2,0.25,0.13,0.1,0.17)
  alpha=0
  Q71 <- (m^2*1+2*m*n*(1/2+1/6*alpha)+2*m*k*(1/5+1/5*alpha)+2*m*e*(1/20+3/20*alpha)+2*m*h*(1/15*alpha)+2*m*f*0+2*m*u*0
          +n^2*(1/4+1/36*alpha^2+1/6*alpha)+2*n*k*(1/10+1/30*alpha^2+2/15*alpha)+2*n*e*(1/40+1/40*alpha^2+1/12*alpha)+2*n*h*(1/90*alpha^2+1/30*alpha)+2*n*f*0+2*n*u*0
          +k^2*(1/25+1/25*alpha^2+2/25*alpha)+2*k*e*(1/100+3/100*alpha^2+1/25*alpha)+2*k*h*(1/75*alpha^2+1/75*alpha)+2*k*f*0+2*k*u*0
          +e^2*(1/400+9/400*alpha^2+3/200*alpha)+2*e*h*(1/100*alpha^2+1/300*alpha)+2*e*f*0+2*e*u*0
          +h^2*(1/225*alpha^2)+2*h*f*0+2*h*u*0
          +f^2*0+2*f*u*0
          +u^2*0)
  
  Q61 <- (m^2*0+2*m*n*(1/2-1/3*alpha)+2*m*k*(3/5-1/3*alpha)+2*m*e*(9/20-3/20*alpha)+2*m*h*(1/5+1/15*alpha)+2*m*f*(1/6*alpha)+2*m*u*0
          +n^2*(1/2-1/9*alpha^2-1/6*alpha)+2*n*k*(2/5-11/90*alpha^2-1/30*alpha)+2*n*e*(1/4-3/40*alpha^2+7/120*alpha)+2*n*h*(1/10-1/90*alpha^2+1/10*alpha)+2*n*f*(1/36*alpha^2+1/12*alpha)+2*n*u*0
          +k^2*(6/25-2/15*alpha^2+8/75*alpha)+2*k*e*(3/25-2/25*alpha^2+2/15*alpha)+2*k*h*(1/25-2/225*alpha^2+7/75*alpha)+2*k*f*(1/30*alpha^2+1/30*alpha)+2*k*u*0
          +e^2*(9/200-9/200*alpha^2+3/25*alpha)+2*e*h*(1/100+19/300*alpha)+2*e*f*(1/40*alpha^2+1/120*alpha)+2*e*u*0
          +h^2*(2/225*alpha^2+2/75*alpha)+2*h*f*(1/90*alpha^2)+2*h*u*0
          +f^2*0+2*f*u*0
          +u^2*0)
  
  Q51 <- (m^2*0+2*m*n*(1/6*alpha)+2*m*k*(1/5+1/15*alpha)+2*m*e*(9/20-3/20*alpha)+2*m*h*(3/5-1/3*alpha)+2*m*f*(1/2-1/3*alpha)+2*m*u*0
          +n^2*(1/4+1/6*alpha^2-1/6*alpha)+2*n*k*(2/5+7/45*alpha^2-4/15*alpha)+2*n*e*(9/20+1/20*alpha^2-13/60*alpha)+2*n*h*(2/5-1/15*alpha^2-1/10*alpha)+2*n*f*(1/4-1/9*alpha^2)+2*n*u*0
          +k^2*(11/25+31/225*alpha^2-22/75*alpha)+2*k*e*(37/100+3/100*alpha^2-11/75*alpha)+2*k*h*(6/25-19/225*alpha^2+1/25*alpha)+2*k*f*(1/10-11/90*alpha^2+2/15*alpha)+2*k*u*0
          +e^2*(99/400-9/400*alpha^2-3/200*alpha)+2*e*h*(3/25-7/100*alpha^2+31/300*alpha)+2*e*f*(1/40-3/40*alpha^2+2/15*alpha)+2*e*u*0
          +h^2*(1/25-9/225*alpha^2+8/75*alpha)+2*h*f*((-1/90)*alpha^2+1/15*alpha)+2*h*u*0
          +f^2*(1/36*alpha^2)+2*f*u*0
          +u^2*0)
  
  Q41 <- (m^2*0+2*m*n*0+2*m*k*(1/15*alpha)+2*m*e*(1/20+3/20*alpha)+2*m*h*(1/5+1/5*alpha)+2*m*f*(1/2+1/6*alpha)+2*m*u*1
          +n^2*((-1/9)*alpha^2+1/6*alpha)+2*n*k*(1/10-1/15*alpha^2+1/10*alpha)+2*n*e*(1/4+1/20*alpha^2-1/15*alpha)+2*n*h*(2/5+7/45*alpha^2-1/5*alpha)+2*n*f*(1/2+1/6*alpha^2-1/6*alpha)+2*n*u*(1/2+1/6*alpha)
          +k^2*(6/25-4/225*alpha^2-2/75*alpha)+2*k*e*(37/100+2/25*alpha^2-59/300*alpha)+2*k*h*(11/25+4/25*alpha^2-22/75*alpha)+2*k*f*(2/5+7/45*alpha^2-1/5*alpha)+2*k*u*(1/5+1/5*alpha)
          +e^2*(41/100+9/100*alpha^2-6/25*alpha)+2*e*h*(37/100+2/25*alpha^2-59/300*alpha)+2*e*f*(1/4+1/20*alpha^2-1/15*alpha)+2*e*u*(1/20+3/20*alpha)
          +h^2*(6/25-4/225*alpha^2-2/75*alpha)+2*h*f*(1/10-1/15*alpha^2+1/10*alpha)+2*h*u*(1/15*alpha)
          +f^2*((-1/9)*alpha^2+1/6*alpha)+2*f*u*0
          +u^2*0)
  
  Q31 <- (m^2*0+2*m*n*0+2*m*k*0+2*m*e*0+2*m*h*0+2*m*f*0+2*m*u*0
          +n^2*(1/36*alpha^2)+2*n*k*((-1/90)*alpha^2+1/15*alpha)+2*n*e*(1/40-3/40*alpha^2+2/15*alpha)+2*n*h*(1/10-11/90*alpha^2+2/15*alpha)+2*n*f*(1/4-1/9*alpha^2)+2*n*u*(1/2-1/3*alpha)
          +k^2*(1/25-9/225*alpha^2+8/75*alpha)+2*k*e*(3/25-7/100*alpha^2+31/300*alpha)+2*k*h*(6/25-19/225*alpha^2+1/25*alpha)+2*k*f*(2/5-1/15*alpha^2-1/10*alpha)+2*k*u*(3/5-1/3*alpha)
          +e^2*(99/400-9/400*alpha^2-3/200*alpha)+2*e*h*(37/100+3/100*alpha^2-11/75*alpha)+2*e*f*(9/20+1/20*alpha^2-13/60*alpha)+2*e*u*(9/20-3/20*alpha)
          +h^2*(11/25+31/225*alpha^2-22/75*alpha)+2*h*f*(2/5+7/45*alpha^2-4/15*alpha)+2*h*u*(1/5+1/15*alpha)
          +f^2*(1/4+1/6*alpha^2-1/6*alpha)+2*f*u*(1/6*alpha)
          +u^2*0)
  
  Q21 <- (m^2*0+2*m*n*0+2*m*k*0+2*m*e*0+2*m*h*0+2*m*f*0+2*m*u*0
          +n^2*0+2*n*k*(1/90*alpha^2)+2*n*e*(1/40*alpha^2+1/120*alpha)+2*n*h*(1/30*alpha^2+1/30*alpha)+2*n*f*(1/36*alpha^2+1/12*alpha)+2*n*u*(1/6*alpha)
          +k^2*(2/225*alpha^2+2/75*alpha)+2*k*e*(1/100+19/300*alpha)+2*k*h*(1/25-2/225*alpha^2+7/75*alpha)+2*k*f*(1/10-1/90*alpha^2+1/10*alpha)+2*k*u*(1/5+1/15*alpha)
          +e^2*(9/200-9/200*alpha^2+3/25*alpha)+2*e*h*(3/25-2/25*alpha^2+2/15*alpha)+2*e*f*(1/4-3/40*alpha^2+7/120*alpha)+2*e*u*(9/20-3/20*alpha)
          +h^2*(6/25-2/15*alpha^2+8/75*alpha)+2*h*f*(2/5-11/90*alpha^2-1/30*alpha)+2*h*u*(3/5-1/3*alpha)
          +f^2*(1/2-1/9*alpha^2-1/6*alpha)+2*f*u*(1/2-1/3*alpha)
          +u^2*0)
  
  Q11 <- (m^2*0+2*m*n*0+2*m*k*0+2*m*e*0+2*m*h*0+2*m*f*0+2*m*u*0
          +n^2*0+2*n*k*0+2*n*e*0+2*n*h*0+2*n*f*0+2*n*u*0
          +k^2*(1/225*alpha^2)+2*k*e*(1/100*alpha^2+1/300*alpha)+2*k*h*(1/75*alpha^2+1/75*alpha)+2*k*f*(1/90*alpha^2+1/30*alpha)+2*k*u*(1/15*alpha)
          +e^2*(1/400+9/400*alpha^2+3/200*alpha)+2*e*h*(1/100+3/100*alpha^2+1/25*alpha)+2*e*f*(1/40+1/40*alpha^2+1/12*alpha)+2*e*u*(1/20+3/20*alpha)
          +h^2*(1/25+1/25*alpha^2+2/25*alpha)+2*h*f*(1/10+1/30*alpha^2+2/15*alpha)+2*h*u*(1/5+1/5*alpha)
          +f^2*(1/4+1/36*alpha^2+1/6*alpha)+2*f*u*(1/2+1/6*alpha)
          +u^2*1)
  prob1 <- c(Q71,Q61,Q51,Q41,Q31,Q21,Q11)  
  
  alpha=1/4
  
  Q7 <-(m^2+1/4*n^2+1/25*k^2+1/400*e^2+m*n+2/5*m*k+1/10*m*e+1/5*n*k+1/20*n*e+1/50*k*e
        +alpha*(1/3*m*n+2/5*m*k+3/10*m*e+2/15*m*h+1/6*n^2+4/15*n*k+1/6*n*e+1/15*n*h+2/25*k^2+2/25*e*k+2/75*k*h+3/200*e^2+1/150*e*h)
        +alpha^2*(1/36*n^2+1/25*k^2+9/400*e^2+1/225*h^2+1/15*n*k+1/20*n*e+1/45*n*h+3/50*k*e+2/75*k*h+1/50*e*h))
  
  Q6 <-((m*n+6/5*m*k+9/10*m*e+2/5*m*h+1/2*n^2+4/5*n*k+1/2*n*e+1/5*n*h+6/25*k^2+6/25*k*e+2/25*k*h+9/200*e^2+1/50*e*h)
        +alpha*(-2/3*m*n-2/3*m*k-3/10*m*e+2/15*m*h+1/3*m*f-1/6*n^2-1/15*n*k+7/60*n*e+1/5*n*h+1/6*n*f+8/75*k^2+4/15*k*e+14/75*k*h+1/15*k*f+3/25*e^2+19/150*e*h+1/60*e*f+2/75*h^2)
        +alpha^2*(-1/9*n^2-11/45*n*k-3/20*n*e-1/45*n*h+1/18*n*f-2/15*k^2-4/25*k*e-4/225*k*h+1/15*k*f-9/200*e^2+1/20*e*f+2/225*h^2+1/45*h*f))
  
  Q5 <- ((2/5*m*k+9/10*m*e+6/5*m*h+m*f+1/4*n^2+4/5*n*k+9/10*n*e+4/5*n*h+1/2*n*f+11/25*k^2+37/50*k*e+12/25*k*h+1/5*k*f+99/400*e^2+6/25*e*h+1/20*e*f+1/25*h^2)
         +alpha*(1/3*m*n+2/15*m*k-3/10*m*e-2/3*m*h-2/3*m*f-1/6*n^2-8/15*n*k-13/30*n*e-1/5*n*h-22/75*k^2-22/75*k*e+2/25*k*h+4/15*k*f-3/200*e^2+31/150*e*h+4/15*e*f+8/75*h^2+2/15*h*f)
         +alpha^2*(1/6*n^2+14/45*n*k+1/10*n*e-2/15*n*h-2/9*n*f+31/225*k^2+3/50*k*e-38/225*k*h-11/45*k*f-9/400*e^2-7/50*e*h-3/20*e*f-9/225*h^2-1/45*h*f+1/36*f^2))
  
  Q4 <- ((1/10*m*e+2/5*m*h+m*f+2*m*u+1/5*n*k+1/2*n*e+4/5*n*h+n*f+n*u+6/25*k^2+37/50*k*e+22/25*k*h+4/5*k*f+2/5*k*u+41/100*e^2+37/50*e*h+1/2*e*f+1/10*e*u+6/25*h^2+1/5*h*f)
         +alpha*(2/15*m*k+3/10*m*e+2/5*m*h+1/3*m*f+1/6*n^2+1/5*n*k-2/15*n*e-2/5*n*h-1/3*n*f+1/3*n*u-2/75*k^2-59/150*k*e-44/75*k*h-2/5*k*f+2/5*k*u-6/25*e^2-59/150*e*h-2/15*e*f+3/10*e*u-2/75*h^2+1/5*h*f+2/15*h*u+1/6*f^2)
         +alpha^2*(-1/9*n^2-2/15*n*k+1/10*n*e+14/45*n*h+1/3*n*f-4/225*k^2+4/25*k*e+8/25*k*h+14/45*k*f+9/100*e^2+4/25*e*h+1/10*e*f-4/225*h^2-2/15*h*f-1/9*f^2))
  
  Q3 <-(alpha^2*(1/36*n^2-1/45*n*k-3/20*n*e-11/45*n*h-2/9*n*f-9/225*k^2-7/50*k*e-38/225*k*h-2/15*k*f-9/400*e^2+3/50*e*h+1/10*e*f+31/225*h^2+14/45*h*f+1/6*f^2)
        +alpha*(2/15*n*k+4/15*n*e+4/15*n*h-2/3*n*u+8/75*k^2+31/150*k*e+2/25*k*h-1/5*k*f-2/3*k*u-3/200*e^2-22/75*e*h-13/30*e*f-3/10*e*u-22/75*h^2-8/15*h*f+2/15*h*u-1/6*f^2+1/3*f*u)
        +(1/20*n*e+1/5*n*h+1/2*n*f+n*u+1/25*k^2+6/25*k*e+12/25*k*h+4/5*k*f+6/5*k*u+99/400*e^2+37/50*e*h+9/10*e*f+9/10*e*u+11/25*h^2+4/5*h*f+2/5*h*u+1/4*f^2))
  
  Q2 <-(alpha^2*(1/45*n*k+1/20*n*e+1/15*n*h+1/18*n*f+2/225*k^2-4/225*k*h-1/45*k*f-9/200*e^2-4/25*e*h-3/20*e*f-2/15*h^2-11/45*h*f-1/9*f^2)
        +alpha*(1/60*n*e+1/15*n*h+1/6*n*f+1/3*n*u+2/75*k^2+19/150*k*e+14/75*k*h+1/5*k*f+2/15*k*u+3/25*e^2+4/15*e*h+7/60*e*f-3/10*e*u+8/75*h^2-1/15*h*f-2/3*h*u-1/6*f^2-2/3*f*u)
        +(1/50*k*e+2/25*k*h+1/5*k*f+2/5*k*u+9/200*e^2+6/25*e*h+1/2*e*f+9/10*e*u+6/25*h^2+4/5*h*f+6/5*h*u+1/2*f^2+f*u))
  
  Q1 <- ((1/400*e^2+1/50*e*h+1/20*e*f+1/10*e*u+1/25*h^2+1/5*h*f+2/5*h*u+1/4*f^2+f*u+u^2)
         +alpha*(1/150*k*e+2/75*k*h+1/15*k*f+2/15*k*u+3/200*e^2+2/25*e*h+1/6*e*f+3/10*e*u+2/25*h^2+4/15*h*f+2/5*h*u+1/6*f^2+1/3*f*u)
         +alpha^2*(1/225*k^2+1/50*k*e+2/75*k*h+1/45*k*f+9/400*e^2+3/50*e*h+1/20*e*f+1/25*h^2+1/15*h*f+1/36*f^2))
 
  prob <- c(Q7,Q6,Q5,Q4,Q3,Q2,Q1)                                                                     
  
  index <- sample(c(1,2,3,4,5,6,7),400,replace = T,prob =prob)
  
  NN <- rep(0,7)
  st <- table(index)
  NNn <- as.numeric(names(st))
  NN[NNn] <- as.numeric(st)
  n7 <- NN[1]; n6 <- NN[2]; n5 <- NN[3]; n4 <- NN[4]
  n3 <- NN[5]; n2 <- NN[6]; n1 <- NN[7]
  N=n7+n6+n5+n4+n3+n2+n1
  
  geno.p <- c()
  for(j in 1:500){
   
    R7 <- m^2+1/4*n^2+1/25*k^2+1/400*e^2+m*n+2/5*m*k+1/10*m*e+1/5*n*k+1/20*n*e+1/50*k*e
    
    R6 <- m*n+6/5*m*k+9/10*m*e+2/5*m*h+1/2*n^2+4/5*n*k+1/2*n*e+1/5*n*h+6/25*k^2+6/25*k*e+2/25*k*h+9/200*e^2+1/50*e*h
    
    R5 <- (2/5*m*k+9/10*m*e+6/5*m*h+m*f+1/4*n^2+4/5*n*k+9/10*n*e+4/5*n*h+1/2*n*f+11/25*k^2+37/50*k*e+12/25*k*h+1/5*k*f
           +99/400*e^2+6/25*e*h+1/20*e*f+1/25*h^2)
    
    R4 <- (1/10*m*e+2/5*m*h+m*f+2*m*u+1/5*n*k+1/2*n*e+4/5*n*h+n*f+n*u+6/25*k^2+37/50*k*e+22/25*k*h+4/5*k*f+2/5*k*u+41/100*e^2
           +37/50*e*h+1/2*e*f+1/10*e*u+6/25*h^2+1/5*h*f)
    
    R3 <- (1/20*n*e+1/5*n*h+1/2*n*f+n*u+1/25*k^2+6/25*k*e+12/25*k*h+4/5*k*f+6/5*k*u
           +99/400*e^2+37/50*e*h+9/10*e*f+9/10*e*u+11/25*h^2+4/5*h*f+2/5*h*u+1/4*f^2)
    
    R2<-(1/50*k*e+2/25*k*h+1/5*k*f+2/5*k*u+9/200*e^2+6/25*e*h+1/2*e*f+9/10*e*u+6/25*h^2+4/5*h*f+6/5*h*u+1/2*f^2+f*u)
    
    R1 <- 1/400*e^2+1/25*h^2+1/4*f^2+u^2+1/50*e*h+1/20*e*f+1/10*e*u+1/5*h*f+2/5*h*u+f*u    
   
    fai7.7= (2*m^2+m*n+2/5*m*k+1/10*m*e)/R7;
    fai7.6=(m*n+6/5*m*k+9/10*m*e+2/5*m*h)/R6;
    fai7.5=(2/5*m*k+9/10*m*e+6/5*m*h+m*f)/R5;
    fai7.4=(1/10*m*e+2/5*m*h+m*f+2*m*u)/R4; 
   
    fai6.7=(1/2*n^2+m*n+1/5*n*k+1/20*n*e)/R7 ;
    fai6.6=(m*n+n^2+4/5*n*k+1/2*n*e+1/5*n*h)/R6
    fai6.5=(1/2*n^2+4/5*n*k+9/10*n*e+4/5*n*h+1/2*n*f)/R5;
    fai6.4=(1/5*n*k+1/2*n*e+4/5*n*h+n*f+n*u)/R4
    fai6.3=(1/20*n*e+1/5*n*h+1/2*n*f+n*u)/R3
   
    fai5.7=(2/25*k^2+2/5*m*k+1/5*n*k+1/50*k*e)/R7
    fai5.6=(6/5*m*k+4/5*n*k+12/25*k^2+6/25*k*e+2/25*k*h)/R6
    fai5.5=(2/5*m*k+4/5*n*k+22/25*k^2+37/50*k*e+12/25*k*h+1/5*k*f)/R5
    fai5.4=(1/5*n*k+12/25*k^2+37/50*k*e+22/25*k*h+4/5*k*f+2/5*k*u)/R4
    fai5.3=(2/25*k^2+6/25*k*e+12/25*k*h+4/5*k*f+6/5*k*u)/R3
    fai5.2=(1/50*k*e+2/25*k*h+1/5*k*f+2/5*k*u)/R2
   
    fai4.7=(1/200*e^2+1/10*m*e+1/20*n*e+1/50*k*e)/R7
    fai4.6=(9/10*m*e+1/2*n*e+6/25*k*e+9/100*e^2+1/50*e*h)/R6
    fai4.5=(9/10*m*e+9/10*n*e+37/50*k*e++99/200*e^2+6/25*e*h+1/20*e*f)/R5
    fai4.4=(1/10*m*e+1/2*n*e+37/50*k*e+41/50*e^2+37/50*e*h+1/2*e*f+1/10*e*u)/R4
    fai4.3=(1/20*n*e+6/25*k*e+99/200*e^2+37/50*e*h+9/10*e*f+9/10*e*u)/R3
    fai4.2=(1/50*k*e+9/100*e^2+6/25*e*h+1/2*e*f+9/10*e*u)/R2
    fai4.1=(1/200*e^2+1/50*e*h+1/20*e*f+1/10*e*u)/R1
    
    fai3.6=(2/5*m*h+1/5*n*h+2/25*k*h+1/50*e*h)/R6
    fai3.5=(6/5*m*h+4/5*n*h+12/25*k*h+6/25*e*h+2/25*h^2)/R5
    fai3.4=(2/5*m*h+4/5*n*h+22/25*k*h+37/50*e*h+12/25*h^2+1/5*h*f)/R4
    fai3.3=(1/5*n*h+12/25*k*h+37/50*e*h+22/25*h^2+4/5*h*f+2/5*h*u)/R3
    fai3.2=(2/25*k*h+6/25*e*h+12/25*h^2+4/5*h*f+6/5*h*u)/R2
    fai3.1=(2/25*h^2+1/50*e*h+1/5*h*f+2/5*h*u)/R1
    
    fai2.5=(m*f+1/2*n*f+1/5*k*f+1/20*e*f)/R5
    fai2.4=(m*f+n*f+4/5*k*f+1/2*e*f+1/5*h*f)/R4
    fai2.3=(1/2*n*f+4/5*k*f+9/10*e*f+4/5*h*f+1/2*f^2)/R3
    fai2.2=(1/5*k*f+1/2*e*f+4/5*h*f+f^2+f*u)/R2
    fai2.1=(1/2*f^2+1/20*e*f+1/5*h*f+f*u)/R1
    
    fai1.4=(2*m*u+n*u+2/5*k*u+1/10*e*u)/R4
    fai1.3=(n*u+6/5*k*u+9/10*e*u+2/5*h*u)/R3
    fai1.2=(2/5*k*u+9/10*e*u+6/5*h*u+f*u)/R2
    fai1.1=(2*u^2+1/10*e*u+2/5*h*u+f*u)/R1
   
    P.6=(fai7.7*n7+fai7.6*n6+fai7.5*n5+fai7.4*n4)/(2*N);
    P.5=(fai6.7*n7+fai6.6*n6+fai6.5*n5+fai6.4*n4+fai6.3*n3)/(2*N);
    P.4=(fai5.7*n7+fai5.6*n6+fai5.5*n5+fai5.4*n4+fai5.3*n3+fai5.2*n2)/(2*N);
    P.3=(fai4.7*n7+fai4.6*n6+fai4.5*n5+fai4.4*n4+fai4.3*n3+fai4.2*n2+fai4.1*n1)/(2*N);
    P.2=(fai3.6*n6+fai3.5*n5+fai3.4*n4+fai3.3*n3+fai3.2*n2+fai3.1*n1)/(2*N);
    P.1=(fai2.5*n5+fai2.4*n4+fai2.3*n3+fai2.2*n2+fai2.1*n1)/(2*N);
    P.0=(fai1.4*n4+fai1.3*n3+fai1.2*n2+fai1.1*n1)/(2*N);
    
    geno.p <- rbind(geno.p,c(P.6,P.5,P.4,P.3,P.2,P.1,P.0))
    m <- P.6;n <- P.5;k <- P.4;e <- P.3;h <- P.2;f <- P.1;u <- P.0
  }
  m <- geno.p[500,1];n <- geno.p[500,2];k <- geno.p[500,3];e<- geno.p[500,4];
  h <- geno.p[500,5];f <- geno.p[500,6];u <- geno.p[500,7];
  geno.L <- rbind(geno.L,c(m,n,k,e,h,f,u))
  
  R.7 <- m^2+1/4*n^2+1/25*k^2+1/400*e^2+m*n+2/5*m*k+1/10*m*e+1/5*n*k+1/20*n*e+1/50*k*e
  
  R.6 <- m*n+6/5*m*k+9/10*m*e+2/5*m*h+1/2*n^2+4/5*n*k+1/2*n*e+1/5*n*h+6/25*k^2+6/25*k*e+2/25*k*h+9/200*e^2+1/50*e*h
  
  R.5 <- (2/5*m*k+9/10*m*e+6/5*m*h+m*f+1/4*n^2+4/5*n*k+9/10*n*e+4/5*n*h+1/2*n*f+11/25*k^2+37/50*k*e+12/25*k*h+1/5*k*f
          +99/400*e^2+6/25*e*h+1/20*e*f+1/25*h^2)
  
  R.4 <- (1/10*m*e+2/5*m*h+m*f+2*m*u+1/5*n*k+1/2*n*e+4/5*n*h+n*f+n*u+6/25*k^2+37/50*k*e+22/25*k*h+4/5*k*f+2/5*k*u+41/100*e^2
          +37/50*e*h+1/2*e*f+1/10*e*u+6/25*h^2+1/5*h*f)
  
  R.3 <- (1/20*n*e+1/5*n*h+1/2*n*f+n*u+1/25*k^2+6/25*k*e+12/25*k*h+4/5*k*f+6/5*k*u
          +99/400*e^2+37/50*e*h+9/10*e*f+9/10*e*u+11/25*h^2+4/5*h*f+2/5*h*u+1/4*f^2)
  
  R.2 <- (1/50*k*e+2/25*k*h+1/5*k*f+2/5*k*u+9/200*e^2+6/25*e*h+1/2*e*f+9/10*e*u+6/25*h^2+4/5*h*f+6/5*h*u+1/2*f^2+f*u)
  
  R.1 <- 1/400*e^2+1/25*h^2+1/4*f^2+u^2+1/50*e*h+1/20*e*f+1/10*e*u+1/5*h*f+2/5*h*u+f*u    
  
  
  exp <- c(R.7,R.6,R.5,R.4,R.3,R.2,R.1) 
  
  logL1 <- (n7*log(exp[1])+n6*log(exp[2])+n5*log(exp[3])+n4*log(exp[4])+n3*log(exp[5])+n2*log(exp[6])+n1*log(exp[7]))
  logL0 <- (n7*log(prob1[1])+n6*log(prob1[2])+n5*log(prob1[3])+n4*log(prob1[4])+n3*log(prob1[5])+n2*log(prob1[6])+n1*log(prob1[7]))
  
  LR <- -2*(logL0-logL1)
  
  lr <- c(lr,LR)
}
